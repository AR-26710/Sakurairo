(()=>{var t={9663:(t,i,e)=>{var s=e(4873).Transform,n=(e(4873).PassThrough,e(1485)),a=e(1374),r={rgb:3,rgba:4,cmyk:4,gray:1,graya:2,indexed:1},h=new Buffer(0);function o(t,i,e){if(s.call(this),"object"==typeof t&&(e=t,t=i=0),this.format={width:t||0,height:i||0,colorSpace:"rgb"},"object"==typeof e)for(var n in e)this.format[n]=e[n];this._consumed=0,this._state=0,this._frameQueue=[];var a=this;this.once("pipe",(function(t){t.on("format",(function(t){for(var i in t)a.format[i]=t[i]})),t.on("frame",this.addFrame.bind(this))}))}n.inherits(o,s),o.prototype.addFrame=function(t){this._frameQueue.push(t)},o.prototype._transform=function(t,i,e){var s=this;!function t(i){switch(s._state){case 0:s._frameSize=s.format.width*s.format.height*r[s.format.colorSpace],s._inputFormat=a(s.format),s._start((function(n){if(n)return e(n);s.emit("format",s.format),s._state=1,t(i)}));break;case 1:var n=s._frameQueue.shift()||{};n.width&&n.height&&(s._frameSize=n.width*n.height*r[s._inputFormat.colorSpace]),s._startFrame(n,(function(a){if(a)return e(a);s.emit("frame",n),s._state=2,t(i)}));break;case 2:if(0===i.length)return e();if(0===s._frameSize){s._state=3,t(h);break}var o=i.slice(0,s._frameSize-s._consumed);s._writePixels(o,(function(n){if(n)return e(n);s._consumed+=o.length,s._consumed===s._frameSize&&(s._state=3),t(i.slice(o.length))}));break;case 3:s._endFrame((function(n){if(n)return e(n);s._consumed=0,s._state=1,i.length?t(i):e()}))}}(t)},o.prototype._flush=function(t){this._end(t)},o.prototype._start=function(t){t()},o.prototype._startFrame=function(t,i){i()},o.prototype._writePixels=function(t,i){i(new Error("No _writePixels implementation"))},o.prototype._endFrame=function(t){t()},o.prototype._end=function(t){t()},t.exports=o},1323:t=>{t.exports=function(t){function i(t,i,e,s){function n(i){"function"!=typeof self.postMessage?t.ports[0].postMessage(i):self.postMessage(i)}e?("undefined"!=typeof console&&"error"in console&&console.error("Worker caught an error:",e),n([i,{message:e.message}])):n([i,null,s])}self.addEventListener("message",(function(e){var s=e.data;if(Array.isArray(s)&&2===s.length){var n=s[0],a=s[1];"function"!=typeof t?i(e,n,new Error("Please pass a function into register().")):function(t,e,s,n){var a,r=function(t,i){try{return{res:t(i)}}catch(t){return{err:t}}}(e,n);r.err?i(t,s,r.err):!(a=r.res)||"object"!=typeof a&&"function"!=typeof a||"function"!=typeof a.then?i(t,s,null,r.res):r.res.then((function(e){i(t,s,null,e)}),(function(e){i(t,s,e)}))}(e,t,n,a)}}))}},1374:t=>{t.exports=function(t){if(!t||"object"!=typeof t)return t;var s;if(e(t)){var n=t.length;s=Array(n);for(var a=0;a<n;a++)s[a]=t[a]}else{var r=i(t);s={};a=0;for(var h=r.length;a<h;a++){var o=r[a];s[o]=t[o]}}return s};var i=Object.keys||function(t){var i=[];for(var e in t)({}).hasOwnProperty.call(t,e)&&i.push(e);return i},e=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)}},4873:()=>{},1485:()=>{}},i={};function e(s){var n=i[s];if(void 0!==n)return n.exports;var a=i[s]={exports:{}};return t[s](a,a.exports,e),a.exports}e.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},e.d=(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},e.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),(()=>{const t=3*Math.max(499,491,487,503),i={ncycles:100,netsize:256,samplefac:10};class s{constructor(t,e){if(function(t){for(let i=1,e=arguments.length;i<e;i++){const e=arguments[i];if(null!=e)for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}}(this,i,{pixels:t},e),this.netsize<4||this.netsize>256)throw new Error("Color count must be between 4 and 256");if(this.samplefac<1||this.samplefac>30)throw new Error("Sampling factor must be between 1 and 30");this.maxnetpos=this.netsize-1,this.netbiasshift=4,this.intbiasshift=16,this.intbias=1<<this.intbiasshift,this.gammashift=10,this.gamma=1<<this.gammashift,this.betashift=10,this.beta=this.intbias>>this.betashift,this.betagamma=this.beta*this.gamma,this.initrad=this.netsize>>3,this.radiusbiasshift=6,this.radiusbias=1<<this.radiusbiasshift,this.initradius=this.initrad*this.radiusbias,this.radiusdec=30,this.alphabiasshift=10,this.initalpha=1<<this.alphabiasshift,this.radbiasshift=8,this.radbias=1<<this.radbiasshift,this.alpharadbshift=this.alphabiasshift+this.radbiasshift,this.alpharadbias=1<<this.alpharadbshift,this.network=[],this.netindex=new Uint32Array(256),this.bias=new Uint32Array(this.netsize),this.freq=new Uint32Array(this.netsize),this.radpower=new Uint32Array(this.netsize>>3);for(let t=0,i=this.netsize;t<i;t++){let i=(t<<this.netbiasshift+8)/this.netsize;this.network[t]=new Float64Array([i,i,i,0]),this.freq[t]=this.intbias/this.netsize,this.bias[t]=0}}unbiasnet(){for(let t=0,i=this.netsize;t<i;t++)this.network[t][0]>>=this.netbiasshift,this.network[t][1]>>=this.netbiasshift,this.network[t][2]>>=this.netbiasshift,this.network[t][3]=t}altersingle(t,i,e,s,n){this.network[i][0]-=t*(this.network[i][0]-e)/this.initalpha,this.network[i][1]-=t*(this.network[i][1]-s)/this.initalpha,this.network[i][2]-=t*(this.network[i][2]-n)/this.initalpha}alterneigh(t,i,e,s,n){const a=Math.abs(i-t),r=Math.min(i+t,this.netsize);let h=i+1,o=i-1,f=1;for(;h<r||o>a;){const t=this.radpower[f++];if(h<r){const i=this.network[h++];i[0]-=t*(i[0]-e)/this.alpharadbias,i[1]-=t*(i[1]-s)/this.alpharadbias,i[2]-=t*(i[2]-n)/this.alpharadbias}if(o>a){const i=this.network[o--];i[0]-=t*(i[0]-e)/this.alpharadbias,i[1]-=t*(i[1]-s)/this.alpharadbias,i[2]-=t*(i[2]-n)/this.alpharadbias}}}contest(t,i,e){let s=~(1<<31),n=s,a=-1,r=a;for(let h=0,o=this.netsize;h<o;h++){let o=this.network[h],f=Math.abs(o[0]-t)+Math.abs(o[1]-i)+Math.abs(o[2]-e);f<s&&(s=f,a=h);let l=f-(this.bias[h]>>this.intbiasshift-this.netbiasshift);l<n&&(n=l,r=h);let c=this.freq[h]>>this.betashift;this.freq[h]-=c,this.bias[h]+=c<<this.gammashift}return this.freq[a]+=this.beta,this.bias[a]-=this.betagamma,r}inxbuild(){let t=0,i=0;for(let e=0,s=this.netsize;e<s;e++){let n=this.network[e],a=null,r=e,h=n[1];for(let t=e+1;t<s;t++)a=this.network[t],a[1]<h&&(r=t,h=a[1]);if(a=this.network[r],e!==r&&([n[0],a[0]]=[a[0],n[0]],[n[1],a[1]]=[a[1],n[1]],[n[2],a[2]]=[a[2],n[2]],[n[3],a[3]]=[a[3],n[3]]),h!==t){this.netindex[t]=i+e>>1;for(let i=t+1;i<h;i++)this.netindex[i]=e;t=h,i=e}}this.netindex[t]=i+this.maxnetpos>>1;for(let i=t+1;i<256;i++)this.netindex[i]=this.maxnetpos}learn(){const i=this.pixels.length,e=30+(this.samplefac-1)/3,s=i/(3*this.samplefac);let n,a=s/this.ncycles|0,r=this.initalpha,h=this.initradius,o=h>>this.radiusbiasshift;o<=1&&(o=0);for(let t=0;t<o;t++)this.radpower[t]=r*((o*o-t*t)*this.radbias/(o*o));i<t?(this.samplefac=1,n=3):n=i%499!=0?1497:i%491!=0?1473:i%487!=0?1461:1509;let f=0;for(let t=0;t<s;){let s=(255&this.pixels[f])<<this.netbiasshift,l=(255&this.pixels[f+1])<<this.netbiasshift,c=(255&this.pixels[f+2])<<this.netbiasshift,u=this.contest(s,l,c);if(this.altersingle(r,u,s,l,c),0!==o&&this.alterneigh(o,u,s,l,c),f+=n,f>=i&&(f-=i),0===a&&(a=1),++t%a==0){r-=r/e,h-=h/this.radiusdec,o=h>>this.radiusbiasshift,o<=1&&(o=0);for(let t=0;t<o;t++)this.radpower[t]=r*((o*o-t*t)*this.radbias/(o*o))}}}buildColorMap(){this.learn(),this.unbiasnet(),this.inxbuild()}getColorMap(){const t=new Uint8Array(3*this.netsize),i=new Uint8Array(this.netsize);for(let t=0,e=this.netsize;t<e;t++)i[this.network[t][3]]=t;for(let e=0,s=0,n=0,a=this.netsize;e<a;e++)n=i[e],t[s++]=255&this.network[n][0],t[s++]=255&this.network[n][1],t[s++]=255&this.network[n][2];return t}}function n(t,i,e,s){let n=0,a=16777216;for(let r=0,h=t.length;r<h;){const h=i-t[r++],o=e-t[r++],f=s-t[r],l=h*h+o*o+f*f;l<a&&(a=l,n=r/3|0),r++}return n}function a(t,i){const e=new s(t,i);return e.buildColorMap(),e.getColorMap()}function r(t,i){const e=new Uint8Array(t.length/3),s={};for(let a=0,r=0,h=t.length;a<h;){const h=t[a++],o=t[a++],f=t[a++],l=h<<16|o<<8|f;e[r++]=l in s?s[l]:s[l]=n(i,h,o,f)}return e}e(9663);var h={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};h.max=h.whitepoint[2].D65,h.rgb=function(t,i){i=i||h.whitepoint[2].E;var e,s,n,a=t[0]/i[0],r=t[1]/i[1],o=t[2]/i[2];return s=-.96924363628087*a+1.87596750150772*r+.041555057407175*o,n=.055630079696993*a+-.20397695888897*r+1.056971514242878*o,e=(e=3.240969941904521*a+-1.537383177570093*r+-.498610760293*o)>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(s=Math.min(Math.max(0,s),1)),255*(n=Math.min(Math.max(0,n),1))]};function o(t,i,e=1){const s=function(t){const i=new Uint8ClampedArray(t.length/4*3),e=t.length;let s=0;for(let n=0;n<e;){for(let e=0;e<3;e++)i[s++]=t[n++];n++}return i}(t),n=a(s,{netsize:i,samplefac:e}),h=r(s,n),o=[],l=n.length;for(let t=0;t<l;)o.push([n[t++],n[t++],n[t++],255]);return{centroid:o,label:f(i,h)}}function f(t,i){const e=new Array(t).fill(0);for(const t of i)e[t]++;return e}function l(t,i){const e=document.createElement("canvas"),s=e.getContext("2d");return e.height=i,e.width=t,s}function c(t,i){return new OffscreenCanvas(t,i).getContext("2d")}h.lab=function(t){var i=t[0],e=t[1],s=t[2];return e/=100,s/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(i-e),200*(e-(s=s>.008856?Math.pow(s,1/3):7.787*s+16/116))]};u.bind(void 0,l),u.bind(void 0,c);function u(t,i){const{naturalWidth:e,naturalHeight:s}=i,n=t(e,s);return n.drawImage(i,0,0,e,s),n.getImageData(0,0,e,s)}p.bind(void 0,l),p.bind(void 0,c);function p(t,i,e){const{naturalWidth:s,naturalHeight:n}=i,a=s*n/e;if(a>1){const e=s/Math.sqrt(a),r=n/Math.sqrt(a),h=t(e,r);return h.drawImage(i,0,0,e,r),h.getImageData(0,0,e,r)}{const e=t(s,n);return e.drawImage(i,0,0),e.getImageData(0,0,s,n)}}var d=e(1323);e.n(d)()((t=>{const{img:i,k:e}=t;return o(i.data,e)}))})()})();
//# sourceMappingURL=1590.js.map