(()=>{var t={1323:t=>{t.exports=function(t){function i(t,i,s,e){function n(i){"function"!=typeof self.postMessage?t.ports[0].postMessage(i):self.postMessage(i)}s?("undefined"!=typeof console&&"error"in console&&console.error("Worker caught an error:",s),n([i,{message:s.message}])):n([i,null,e])}self.addEventListener("message",(function(s){var e=s.data;if(Array.isArray(e)&&2===e.length){var n=e[0],a=e[1];"function"!=typeof t?i(s,n,new Error("Please pass a function into register().")):function(t,s,e,n){var a,h=function(t,i){try{return{res:t(i)}}catch(t){return{err:t}}}(s,n);h.err?i(t,e,h.err):!(a=h.res)||"object"!=typeof a&&"function"!=typeof a||"function"!=typeof a.then?i(t,e,null,h.res):h.res.then((function(s){i(t,e,null,s)}),(function(s){i(t,e,s)}))}(s,t,n,a)}}))}}},i={};function s(e){var n=i[e];if(void 0!==n)return n.exports;var a=i[e]={exports:{}};return t[e](a,a.exports,s),a.exports}s.n=t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return s.d(i,{a:i}),i},s.d=(t,i)=>{for(var e in i)s.o(i,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},s.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i);var e={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};e.max=e.whitepoint[2].D65,e.rgb=function(t,i){i=i||e.whitepoint[2].E;var s,n,a,h=t[0]/i[0],r=t[1]/i[1],o=t[2]/i[2];return n=-.96924363628087*h+1.87596750150772*r+.041555057407175*o,a=.055630079696993*h+-.20397695888897*r+1.056971514242878*o,s=(s=3.240969941904521*h+-1.537383177570093*r+-.498610760293*o)>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*=12.92,[255*(s=Math.min(Math.max(0,s),1)),255*(n=Math.min(Math.max(0,n),1)),255*(a=Math.min(Math.max(0,a),1))]};e.lab=function(t){var i=t[0],s=t[1],e=t[2];return s/=100,e/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(s=s>.008856?Math.pow(s,1/3):7.787*s+16/116)-16,500*(i-s),200*(s-(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116))]};const n=3*Math.max(499,491,487,503),a={ncycles:100,netsize:256,samplefac:10};class h{constructor(t,i){if(function(t){for(let i=1,s=arguments.length;i<s;i++){const s=arguments[i];if(null!=s)for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}}(this,a,{pixels:t},i),this.netsize<4||this.netsize>256)throw new Error("Color count must be between 4 and 256");if(this.samplefac<1||this.samplefac>30)throw new Error("Sampling factor must be between 1 and 30");this.maxnetpos=this.netsize-1,this.netbiasshift=4,this.intbiasshift=16,this.intbias=1<<this.intbiasshift,this.gammashift=10,this.gamma=1<<this.gammashift,this.betashift=10,this.beta=this.intbias>>this.betashift,this.betagamma=this.beta*this.gamma,this.initrad=this.netsize>>3,this.radiusbiasshift=6,this.radiusbias=1<<this.radiusbiasshift,this.initradius=this.initrad*this.radiusbias,this.radiusdec=30,this.alphabiasshift=10,this.initalpha=1<<this.alphabiasshift,this.radbiasshift=8,this.radbias=1<<this.radbiasshift,this.alpharadbshift=this.alphabiasshift+this.radbiasshift,this.alpharadbias=1<<this.alpharadbshift,this.network=[],this.netindex=new Uint32Array(256),this.bias=new Uint32Array(this.netsize),this.freq=new Uint32Array(this.netsize),this.radpower=new Uint32Array(this.netsize>>3);for(let t=0,i=this.netsize;t<i;t++){let i=(t<<this.netbiasshift+8)/this.netsize;this.network[t]=new Float64Array([i,i,i,0]),this.freq[t]=this.intbias/this.netsize,this.bias[t]=0}}unbiasnet(){for(let t=0,i=this.netsize;t<i;t++)this.network[t][0]>>=this.netbiasshift,this.network[t][1]>>=this.netbiasshift,this.network[t][2]>>=this.netbiasshift,this.network[t][3]=t}altersingle(t,i,s,e,n){this.network[i][0]-=t*(this.network[i][0]-s)/this.initalpha,this.network[i][1]-=t*(this.network[i][1]-e)/this.initalpha,this.network[i][2]-=t*(this.network[i][2]-n)/this.initalpha}alterneigh(t,i,s,e,n){const a=Math.abs(i-t),h=Math.min(i+t,this.netsize);let r=i+1,o=i-1,l=1;for(;r<h||o>a;){const t=this.radpower[l++];if(r<h){const i=this.network[r++];i[0]-=t*(i[0]-s)/this.alpharadbias,i[1]-=t*(i[1]-e)/this.alpharadbias,i[2]-=t*(i[2]-n)/this.alpharadbias}if(o>a){const i=this.network[o--];i[0]-=t*(i[0]-s)/this.alpharadbias,i[1]-=t*(i[1]-e)/this.alpharadbias,i[2]-=t*(i[2]-n)/this.alpharadbias}}}contest(t,i,s){let e=~(1<<31),n=e,a=-1,h=a;for(let r=0,o=this.netsize;r<o;r++){let o=this.network[r],l=Math.abs(o[0]-t)+Math.abs(o[1]-i)+Math.abs(o[2]-s);l<e&&(e=l,a=r);let f=l-(this.bias[r]>>this.intbiasshift-this.netbiasshift);f<n&&(n=f,h=r);let c=this.freq[r]>>this.betashift;this.freq[r]-=c,this.bias[r]+=c<<this.gammashift}return this.freq[a]+=this.beta,this.bias[a]-=this.betagamma,h}inxbuild(){let t=0,i=0;for(let s=0,e=this.netsize;s<e;s++){let n=this.network[s],a=null,h=s,r=n[1];for(let t=s+1;t<e;t++)a=this.network[t],a[1]<r&&(h=t,r=a[1]);if(a=this.network[h],s!==h&&([n[0],a[0]]=[a[0],n[0]],[n[1],a[1]]=[a[1],n[1]],[n[2],a[2]]=[a[2],n[2]],[n[3],a[3]]=[a[3],n[3]]),r!==t){this.netindex[t]=i+s>>1;for(let i=t+1;i<r;i++)this.netindex[i]=s;t=r,i=s}}this.netindex[t]=i+this.maxnetpos>>1;for(let i=t+1;i<256;i++)this.netindex[i]=this.maxnetpos}learn(){const t=this.pixels.length,i=30+(this.samplefac-1)/3,s=t/(3*this.samplefac);let e,a=s/this.ncycles|0,h=this.initalpha,r=this.initradius,o=r>>this.radiusbiasshift;o<=1&&(o=0);for(let t=0;t<o;t++)this.radpower[t]=h*((o*o-t*t)*this.radbias/(o*o));t<n?(this.samplefac=1,e=3):e=t%499!=0?1497:t%491!=0?1473:t%487!=0?1461:1509;let l=0;for(let n=0;n<s;){let s=(255&this.pixels[l])<<this.netbiasshift,f=(255&this.pixels[l+1])<<this.netbiasshift,c=(255&this.pixels[l+2])<<this.netbiasshift,u=this.contest(s,f,c);if(this.altersingle(h,u,s,f,c),0!==o&&this.alterneigh(o,u,s,f,c),l+=e,l>=t&&(l-=t),0===a&&(a=1),++n%a==0){h-=h/i,r-=r/this.radiusdec,o=r>>this.radiusbiasshift,o<=1&&(o=0);for(let t=0;t<o;t++)this.radpower[t]=h*((o*o-t*t)*this.radbias/(o*o))}}}buildColorMap(){this.learn(),this.unbiasnet(),this.inxbuild()}getColorMap(){const t=new Uint8Array(3*this.netsize),i=new Uint8Array(this.netsize);for(let t=0,s=this.netsize;t<s;t++)i[this.network[t][3]]=t;for(let s=0,e=0,n=0,a=this.netsize;s<a;s++)n=i[s],t[e++]=255&this.network[n][0],t[e++]=255&this.network[n][1],t[e++]=255&this.network[n][2];return t}}function r(t,i,s,e){let n=0,a=16777216;for(let h=0,r=t.length;h<r;){const r=i-t[h++],o=s-t[h++],l=e-t[h],f=r*r+o*o+l*l;f<a&&(a=f,n=h/3|0),h++}return n}function o(t,i,s=1){const e=function(t){const i=new Uint8ClampedArray(t.length/4*3),s=t.length;let e=0;for(let n=0;n<s;){for(let s=0;s<3;s++)i[e++]=t[n++];n++}return i}(t),n=function(t,i){const s=new h(t,i);return s.buildColorMap(),s.getColorMap()}(e,{netsize:i,samplefac:s}),a=function(t,i){const s=new Uint8Array(t.length/3),e={};for(let n=0,a=0,h=t.length;n<h;){const h=t[n++],o=t[n++],l=t[n++],f=h<<16|o<<8|l;s[a++]=f in e?e[f]:e[f]=r(i,h,o,l)}return s}(e,n),o=[],f=n.length;for(let t=0;t<f;)o.push([n[t++],n[t++],n[t++],255]);return{centroid:o,label:l(i,a)}}function l(t,i){const s=new Array(t).fill(0);for(const t of i)s[t]++;return s}function f(t,i){const s=document.createElement("canvas"),e=s.getContext("2d");return s.height=i,s.width=t,e}function c(t,i){return new OffscreenCanvas(t,i).getContext("2d")}function u(t,i){const{naturalWidth:s,naturalHeight:e}=i,n=t(s,e);return n.drawImage(i,0,0,s,e),n.getImageData(0,0,s,e)}u.bind(void 0,f),u.bind(void 0,c);function b(t,i,s){let{naturalWidth:e,naturalHeight:n}=i;const a=e*n/s;if(a>1){const t=Math.sqrt(a);e=e/t|0,n=n/t|0}const h=t(e,n);return h.drawImage(i,0,0,e,n),h.getImageData(0,0,e,n)}b.bind(void 0,f),b.bind(void 0,c);var p=s(1323);s.n(p)()((t=>{const{img:i,k:s}=t;return o(i.data,s)}))})();
//# sourceMappingURL=7398.js.map